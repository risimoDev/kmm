{
  "name": "01 â€” ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚-Ğ¼Ğ¾Ğ·Ğ³",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "content-brain",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "ğŸ“¥ Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [200, 300],
      "webhookId": "content-brain"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT key, value FROM app_settings WHERE key IN ('ai_model', 'ai_base_url', 'ai_system_prompt') ORDER BY key;",
        "options": {}
      },
      "id": "load-settings",
      "name": "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [440, 300],
      "credentials": {
        "postgres": {
          "id": "BXL7joPD69X9xNOu",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const rows = $('âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”').all().map(i => i.json);\nconst settingsMap = {};\nfor (const r of (Array.isArray(rows[0]) ? rows[0] : rows)) {\n  if (r.key) settingsMap[r.key] = r.value;\n}\nconst input = $('ğŸ“¥ Webhook').first().json;\nconst body = input.body || input;\nreturn [{ json: {\n  ai_base_url: settingsMap.ai_base_url || 'https://gptunnel.ru/v1',\n  ai_model: settingsMap.ai_model || 'gpt-4o',\n  system_prompt: body.system_prompt || settingsMap.ai_system_prompt || 'Ğ¢Ñ‹ â€” ĞºÑ€ĞµĞ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ»Ğ¾Ğ³.',\n  count: body.count || 3,\n  product_name: body.product_name || '',\n  niche: body.niche || '',\n  extra_instructions: body.extra_instructions || ''\n}}];"
      },
      "id": "prepare-config",
      "name": "ğŸ”§ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "jsCode": "const cfg = $input.first().json;\nconst systemPrompt = cfg.system_prompt + '\\n\\nĞ¢Ñ‹ â€” Ğ¾Ğ¿Ñ‹Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚-ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³ Ğ¸ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ»Ğ¾Ğ³, ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ÑÑ Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ²Ğ¸Ñ€ÑƒÑĞ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° Ğ´Ğ»Ñ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¿Ğ»ĞµĞ¹ÑĞ¾Ğ² Ğ¸ ÑĞ¾Ñ†ÑĞµÑ‚ĞµĞ¹ (Wildberries, Ozon, VK ĞšĞ»Ğ¸Ğ¿Ñ‹, YouTube Shorts, TikTok, Reels).\\n\\nĞ¢Ğ²Ğ¾Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° â€” Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ, Ğ¿Ñ€Ğ¾Ğ´ÑƒĞ¼Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ´ĞµĞ¸ Ğ´Ğ»Ñ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ñ… Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾ (15-60 ÑĞµĞº).\\n\\nĞ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ¸Ğ´ĞµĞµ:\\n- Ğ¦ĞµĞ¿Ğ»ÑÑÑ‰Ğ¸Ğ¹ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¾ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞºÑ€Ğ¾Ğ»Ğ» (Ğ´Ğ¾ 60 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)\\n- Ğ§Ñ‘Ñ‚ĞºĞ°Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¼ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ½Ñ‹Ğ¼ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ¾Ğ¼: Ğ´Ğ¾/Ğ¿Ğ¾ÑĞ»Ğµ, Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ°, Ğ»Ğ°Ğ¹Ñ„Ñ…Ğ°Ğº, ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ, ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‚ĞµĞ»Ğ»Ğ¸Ğ½Ğ³, ÑˆĞ¾ĞºĞ¾Ğ²Ñ‹Ğ¹-Ñ„Ğ°ĞºÑ‚, ASMR, Ñ‚Ğ°Ğ¹Ğ¼Ğ»Ğ°Ğ¿Ñ, ÑĞ¼Ğ¾Ñ€\\n- ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ñ€ÑĞ´Ğ°: ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ ĞºĞ°Ğ´Ñ€Ñ‹, Ñ€Ğ°ĞºÑƒÑ€ÑÑ‹, Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ‹, Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ¿Ğ°Ğ»Ğ¸Ñ‚Ñ€Ğ°\\n- Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ Ñ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ¾Ğ¼, Ğ¿Ğ¾Ğ»Ğ¾Ğ¼, Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°Ğ¼Ğ¸\\n- Ğ¢Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ, Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ°Ñ Ğ´Ğ»Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸\\n\\nĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¸Ğ´ĞµÑ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ ĞĞ—ĞĞ«Ğ™ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼!\\n\\nĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ğ¡Ğ¢Ğ ĞĞ“Ğ Ğ² JSON:\\n{\\n  \"ideas\": [\\n    {\\n      \"title\": \"Ğ¦ĞµĞ¿Ğ»ÑÑÑ‰Ğ¸Ğ¹ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº (Ğ´Ğ¾ 60 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)\",\\n      \"category\": \"Ğ¾Ğ±Ğ·Ğ¾Ñ€ | Ğ»Ğ°Ğ¹Ñ„Ñ…Ğ°Ğº | Ğ´Ğ¾-Ğ¿Ğ¾ÑĞ»Ğµ | Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ° | ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ | ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‚ĞµĞ»Ğ»Ğ¸Ğ½Ğ³ | ÑĞ¼Ğ¾Ñ€ | Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ | ASMR\",\\n      \"concept\": \"ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ½Ğ° 3-5 Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹\",\\n      \"visual_description\": \"Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ÑĞ´: 1) Ğ¥ÑƒĞº-ĞºĞ°Ğ´Ñ€ (0-3 ÑĞµĞº). 2) ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ. 3) ĞšÑƒĞ»ÑŒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ. 4) Ğ¤Ğ¸Ğ½Ğ°Ğ» â€” CTA\",\\n      \"target_audience\": \"ĞŸĞ¾Ğ», Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚ 18-35, Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑÑ‹\",\\n      \"tone\": \"ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ | ÑĞ¿Ğ¾ĞºĞ¾Ğ¹Ğ½Ñ‹Ğ¹ | ÑĞ¼Ğ¾Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ | ÑĞºÑĞ¿ĞµÑ€Ñ‚Ğ½Ñ‹Ğ¹ | Ğ²Ğ´Ğ¾Ñ…Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‰Ğ¸Ğ¹\"\\n    }\\n  ]\\n}';\nlet userMsg = `Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞ¹ ${cfg.count} ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¸Ğ´ĞµĞ¹ Ğ´Ğ»Ñ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾ (15-60 ÑĞµĞº). ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¸Ğ´ĞµÑ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ ĞĞ—ĞĞ«Ğ™ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼.`;\nif (cfg.product_name) userMsg += `\\nĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚: ${cfg.product_name}.`;\nif (cfg.niche) userMsg += `\\nĞĞ¸ÑˆĞ°: ${cfg.niche}.`;\nif (cfg.extra_instructions) userMsg += `\\nĞ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾: ${cfg.extra_instructions}`;\nuserMsg += '\\nĞ’Ğ°Ğ¶Ğ½Ğ¾: ĞºĞ°Ğ¶Ğ´Ğ°Ñ Ğ¸Ğ´ĞµÑ ÑĞ°Ğ¼Ğ¾Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ â€” Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ Ğ¸ Ğ²Ğ¸Ğ´ĞµĞ¾Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°.';\nreturn [{ json: {\n  url: cfg.ai_base_url + '/chat/completions',\n  body: JSON.stringify({\n    model: cfg.ai_model,\n    temperature: 0.92,\n    max_tokens: 4000,\n    response_format: { type: 'json_object' },\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: userMsg }\n    ]\n  })\n}}];"
      },
      "id": "build-ideas-body",
      "name": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸Ğ´ĞµĞ¹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [920, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.body }}",
        "options": { "timeout": 90000 }
      },
      "id": "generate-ideas",
      "name": "ğŸ§  Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ´ĞµĞ¹",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1160, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "YTA7VkJwvfpfaJec",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const response = $input.first().json;\nconst body = response.body || response;\nlet parsed;\ntry {\n  const content = body.choices[0].message.content;\n  parsed = JSON.parse(content);\n} catch (e) {\n  throw new Error('AI ideas parse error: ' + e.message);\n}\nconst ideas = parsed.ideas || [];\nif (ideas.length === 0) throw new Error('AI returned empty ideas list');\nreturn ideas.map(idea => ({ json: { ...idea } }));"
      },
      "id": "parse-ideas",
      "name": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ¸Ğ´ĞµĞ¹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1400, 300]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO content_ideas (title, category, concept, visual_description, target_audience, tone, status)\nVALUES (\n'{{ ($json.title || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ ($json.category || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ ($json.concept || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ ($json.visual_description || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ ($json.target_audience || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ ($json.tone || \"\").toString().split(\"'\").join(\"''\") }}',\n'draft'\n)\nRETURNING id, title, category, concept, visual_description, target_audience, tone, status, created_at;",
        "options": {}
      },
      "id": "save-idea",
      "name": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ´ĞµÑ",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [1640, 300],
      "credentials": {
        "postgres": {
          "id": "BXL7joPD69X9xNOu",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const config = $('ğŸ”§ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°').first().json;\nreturn $input.all().map(item => ({\n  json: {\n    idea_id: item.json.id,\n    title: item.json.title,\n    concept: item.json.concept,\n    visual_description: item.json.visual_description || '',\n    target_audience: item.json.target_audience || '',\n    tone: item.json.tone || '',\n    category: item.json.category || '',\n    ai_base_url: config.ai_base_url,\n    ai_model: config.ai_model\n  }\n}));"
      },
      "id": "prepare-script-context",
      "name": "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1880, 300]
    },
    {
      "parameters": {
        "jsCode": "const systemPrompt = 'Ğ¢Ñ‹ â€” Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ÑÑ‚ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ñ… Ğ²Ğ¸Ñ€ÑƒÑĞ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ´Ğ»Ñ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¿Ğ»ĞµĞ¹ÑĞ¾Ğ² Ğ¸ ÑĞ¾Ñ†ÑĞµÑ‚ĞµĞ¹.\\n\\nĞ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ:\\n- ĞŸĞµÑ€Ğ²Ñ‹Ğµ 2-3 ÑĞµĞº: ĞœĞĞ©ĞĞ«Ğ™ Ñ…ÑƒĞº (Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ, ÑˆĞ¾ĞºĞ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ Ñ„Ğ°ĞºÑ‚, Ğ¿Ñ€Ğ¾Ğ²Ğ¾ĞºĞ°Ñ†Ğ¸Ñ)\\n- Ğ”Ğ°Ğ»ĞµĞµ: Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ñ‚ĞµĞ¼Ñ‹ Ñ Ğ½Ğ°Ñ€Ğ°ÑÑ‚Ğ°ÑÑ‰Ğ¸Ğ¼ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ¾Ğ¼\\n- ĞšÑƒĞ»ÑŒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ: ĞºĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ / Ğ²Ğ°Ñƒ-Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚\\n- Ğ¤Ğ¸Ğ½Ğ°Ğ»: Ğ¿Ñ€Ğ¸Ğ·Ñ‹Ğ² Ğº Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ\\n- Ğ¯Ğ·Ñ‹Ğº: Ğ¶Ğ¸Ğ²Ğ¾Ğ¹, Ñ€Ğ°Ğ·Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ½Ñ‹Ğ¹, Ğ±ĞµĞ· ĞºĞ°Ğ½Ñ†ĞµĞ»ÑÑ€Ğ¸Ğ·Ğ¼Ğ¾Ğ²\\n- Ğ”Ğ»Ğ¸Ğ½Ğ°: 80-150 ÑĞ»Ğ¾Ğ² (35-55 ÑĞµĞº Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸)\\n- ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ñ„Ñ€Ğ°Ğ·Ğ° = Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ğ¾Ğ²\\n\\nĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ğ¡Ğ¢Ğ ĞĞ“Ğ Ğ² JSON:\\n{\\n  \"script_text\": \"ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸\",\\n  \"hook\": \"Ğ¥ÑƒĞº â€” Ğ¿ĞµÑ€Ğ²Ğ°Ñ Ñ„Ñ€Ğ°Ğ·Ğ°\",\\n  \"cta\": \"ĞŸÑ€Ğ¸Ğ·Ñ‹Ğ² Ğº Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ\",\\n  \"word_count\": 95,\\n  \"duration_hint\": 40,\\n  \"timing_marks\": [\\n    { \"time\": 0, \"text\": \"Ğ¥ÑƒĞº\" },\\n    { \"time\": 3, \"text\": \"Ğ Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ 1\" },\\n    { \"time\": 10, \"text\": \"Ğ Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ 2\" },\\n    { \"time\": 20, \"text\": \"ĞšÑƒĞ»ÑŒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ\" },\\n    { \"time\": 30, \"text\": \"CTA\" }\\n  ]\\n}';\nreturn $input.all().map(item => {\n  const ctx = item.json;\n  const userMsg = `ĞĞ°Ğ¿Ğ¸ÑˆĞ¸ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸ Ğ´Ğ»Ñ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğ³Ğ¾ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾.\\n\\nĞ˜Ğ´ĞµÑ: ${ctx.title}\\nĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ: ${ctx.category}\\nĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ: ${ctx.concept}\\nĞ¢Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: ${ctx.tone}\\nĞ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ: ${ctx.target_audience}\\nĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ°: ${ctx.visual_description}\\n\\nĞ’Ğ°Ğ¶Ğ½Ğ¾:\\n1. Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ğ¾Ğ¼Ñƒ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ€ÑĞ´Ñƒ\\n2. Ğ¥ÑƒĞº Ğ² Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 2-3 ÑĞµĞºÑƒĞ½Ğ´Ñ‹\\n3. ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€ÑƒĞ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ´ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸ Ñ‚Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ`;\n  return { json: {\n    url: ctx.ai_base_url + '/chat/completions',\n    body: JSON.stringify({\n      model: ctx.ai_model,\n      temperature: 0.75,\n      max_tokens: 3000,\n      response_format: { type: 'json_object' },\n      messages: [\n        { role: 'system', content: systemPrompt },\n        { role: 'user', content: userMsg }\n      ]\n    })\n  }};\n});"
      },
      "id": "build-script-body",
      "name": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2120, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.body }}",
        "options": { "timeout": 90000 }
      },
      "id": "generate-script",
      "name": "ğŸ“ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2360, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "YTA7VkJwvfpfaJec",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const ctxAll = $('ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ').all();\nreturn $input.all().map((item, idx) => {\n  const body = item.json.body || item.json;\n  let parsed;\n  try {\n    const content = body.choices[0].message.content;\n    parsed = JSON.parse(content);\n  } catch (e) {\n    throw new Error('Script parse error at index ' + idx + ': ' + e.message);\n  }\n  const myCtx = (ctxAll[idx] || ctxAll[0]).json;\n  return { json: {\n    ...parsed,\n    idea_id: myCtx.idea_id,\n    title: myCtx.title,\n    concept: myCtx.concept,\n    visual_description: myCtx.visual_description,\n    target_audience: myCtx.target_audience,\n    tone: myCtx.tone,\n    category: myCtx.category,\n    ai_base_url: myCtx.ai_base_url,\n    ai_model: myCtx.ai_model\n  }};\n});"
      },
      "id": "parse-script",
      "name": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2600, 300]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO voice_scripts (idea_id, script_text, word_count, duration_hint, timing_marks, status)\nVALUES (\n{{ $json.idea_id }},\n'{{ ($json.script_text || \"\").toString().split(\"'\").join(\"''\") }}',\n{{ $json.word_count || 0 }},\n{{ $json.duration_hint || 0 }},\n'{{ JSON.stringify($json.timing_marks || []).split(\"'\").join(\"''\") }}'::jsonb,\n'draft'\n)\nRETURNING id, idea_id, script_text, word_count, duration_hint, status;",
        "options": {}
      },
      "id": "save-script",
      "name": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [2840, 300],
      "credentials": {
        "postgres": {
          "id": "BXL7joPD69X9xNOu",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const ctxAll = $('ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ').all();\nconst scriptAll = $('ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ').all();\nreturn $input.all().map((item, idx) => {\n  const scriptSaved = item.json;\n  const myCtx = (ctxAll[idx] || ctxAll[0]).json;\n  const myScript = (scriptAll[idx] || scriptAll[0]).json;\n  return { json: {\n    idea_id: myCtx.idea_id,\n    script_id: scriptSaved.id,\n    title: myCtx.title,\n    concept: myCtx.concept,\n    visual_description: myCtx.visual_description,\n    target_audience: myCtx.target_audience,\n    tone: myCtx.tone,\n    category: myCtx.category,\n    script_text: myScript.script_text || '',\n    hook: myScript.hook || '',\n    timing_marks: myScript.timing_marks || [],\n    ai_base_url: myCtx.ai_base_url,\n    ai_model: myCtx.ai_model\n  }};\n});"
      },
      "id": "prepare-video-prompt-context",
      "name": "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3080, 300]
    },
    {
      "parameters": {
        "jsCode": "const systemPrompt = 'Ğ¢Ñ‹ â€” Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸ÑÑÑ‘Ñ€ Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑÑĞµÑ€, ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ÑÑ Ğ½Ğ° AI-Ğ²Ğ¸Ğ´ĞµĞ¾Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ (Minimax, Runway ML, Kling AI, Sora, Pika).\\n\\nĞ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ñƒ:\\n- ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ½Ğ° ĞĞĞ“Ğ›Ğ˜Ğ™Ğ¡ĞšĞĞœ ÑĞ·Ñ‹ĞºĞµ\\n- ĞšĞ°Ğ¶Ğ´Ğ°Ñ ÑÑ†ĞµĞ½Ğ° Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ° Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾: ĞºĞ°Ğ¼ĞµÑ€Ğ° (pan, zoom, dolly, static, orbital), Ğ¾ÑĞ²ĞµÑ‰ĞµĞ½Ğ¸Ğµ (soft, dramatic, natural, neon), Ñ†Ğ²ĞµÑ‚Ğ°, Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹, Ñ‚ĞµĞºÑÑ‚ÑƒÑ€Ñ‹\\n- Ğ¡Ñ‚Ğ¸Ğ»ÑŒ: cinematic, product-shot, lifestyle, flat-lay, stop-motion, animation, hyper-realistic\\n- Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ Ñ‚Ğ°Ğ¹Ğ¼Ğ¸Ğ½Ğ³Ğ°Ğ¼Ğ¸ Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸\\n- ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ‹: cut, fade, zoom-in, morph, swipe, whip-pan\\n- ĞŸĞµÑ€Ğ²Ğ°Ñ ÑÑ†ĞµĞ½Ğ° â€” Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ…ÑƒĞº (2 ÑĞµĞº)\\n- Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: 9:16\\n\\nĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ğ¡Ğ¢Ğ ĞĞ“Ğ Ğ² JSON:\\n{\\n  \"prompt_text\": \"Main video generation prompt in English. One detailed paragraph.\",\\n  \"scene_descriptions\": [\\n    {\\n      \"order\": 1,\\n      \"duration\": 3,\\n      \"description\": \"Detailed scene description in English\",\\n      \"camera_movement\": \"static | pan-left | zoom-in | dolly | orbital\",\\n      \"transition\": \"cut | fade | zoom | morph | swipe\"\\n    }\\n  ],\\n  \"style_reference\": \"cinematic | product-shot | lifestyle | animation\",\\n  \"aspect_ratio\": \"9:16\",\\n  \"mood\": \"Dynamic | Calm | Exciting | Professional\",\\n  \"color_palette\": \"Color palette description\"\\n}';\nreturn $input.all().map(item => {\n  const ctx = item.json;\n  const userMsg = `Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ´Ğ»Ñ AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾ 9:16.\\n\\nĞ˜Ğ´ĞµÑ: ${ctx.title}\\nĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ: ${ctx.category}\\nĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ: ${ctx.concept}\\nĞ¢Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: ${ctx.tone}\\nĞ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ: ${ctx.target_audience}\\nĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ° Ğ¸Ğ· Ğ¸Ğ´ĞµĞ¸: ${ctx.visual_description}\\n\\nĞ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸:\\n${ctx.script_text}\\n\\nĞ¥ÑƒĞº: ${ctx.hook}\\n\\nĞ¢Ğ°Ğ¹Ğ¼Ğ¸Ğ½Ğ³Ğ¸: ${JSON.stringify(ctx.timing_marks)}\\n\\nĞ’Ğ°Ğ¶Ğ½Ğ¾:\\n1. ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ¸ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ ÑÑ†ĞµĞ½ â€” Ğ½Ğ° ĞĞĞ“Ğ›Ğ˜Ğ™Ğ¡ĞšĞĞœ\\n2. ĞšĞ°Ğ¶Ğ´Ğ°Ñ ÑÑ†ĞµĞ½Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ„Ñ€Ğ°Ğ·Ğµ Ğ¸Ğ· ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ\\n3. ĞŸĞµÑ€Ğ²Ğ°Ñ ÑÑ†ĞµĞ½Ğ° (0-3 ÑĞµĞº) â€” ÑÑ€ĞºĞ¸Ğ¹ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ…ÑƒĞº\\n4. Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: vertical 9:16`;\n  return { json: {\n    url: ctx.ai_base_url + '/chat/completions',\n    body: JSON.stringify({\n      model: ctx.ai_model,\n      temperature: 0.8,\n      max_tokens: 3000,\n      response_format: { type: 'json_object' },\n      messages: [\n        { role: 'system', content: systemPrompt },\n        { role: 'user', content: userMsg }\n      ]\n    })\n  }};\n});"
      },
      "id": "build-video-prompt-body",
      "name": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3320, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.body }}",
        "options": { "timeout": 90000 }
      },
      "id": "generate-video-prompt",
      "name": "ğŸ¬ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [3560, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "YTA7VkJwvfpfaJec",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const ctxAll = $('ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°').all();\nreturn $input.all().map((item, idx) => {\n  const body = item.json.body || item.json;\n  let parsed;\n  try {\n    const content = body.choices[0].message.content;\n    parsed = JSON.parse(content);\n  } catch (e) {\n    throw new Error('Video prompt parse error at index ' + idx + ': ' + e.message);\n  }\n  const myCtx = (ctxAll[idx] || ctxAll[0]).json;\n  return { json: {\n    ...parsed,\n    idea_id: myCtx.idea_id,\n    script_id: myCtx.script_id\n  }};\n});"
      },
      "id": "parse-video-prompt",
      "name": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3800, 300]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO video_prompts (idea_id, prompt_text, scene_descriptions, style_reference, status)\nVALUES (\n{{ $json.idea_id }},\n'{{ ($json.prompt_text || \"\").toString().split(\"'\").join(\"''\") }}',\n'{{ JSON.stringify($json.scene_descriptions || []).split(\"'\").join(\"''\") }}'::jsonb,\n'{{ ($json.style_reference || \"\").toString().split(\"'\").join(\"''\") }}',\n'draft'\n)\nRETURNING id, idea_id, prompt_text, style_reference, status;",
        "options": {}
      },
      "id": "save-video-prompt",
      "name": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [4040, 300],
      "credentials": {
        "postgres": {
          "id": "BXL7joPD69X9xNOu",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://dashboard:3001/api/internal/content-ready",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"idea_id\": {{ $json.idea_id }},\n  \"video_prompt_id\": {{ $json.id }},\n  \"status\": \"ready\"\n}",
        "options": { "timeout": 10000 },
        "onError": "continueRegularOutput"
      },
      "id": "callback",
      "name": "ğŸ“¡ Callback â†’ Dashboard",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [4280, 300]
    },
    {
      "parameters": {
        "jsCode": "const ideas = $('ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ´ĞµÑ').all().map(i => i.json);\nconst scripts = $('ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹').all().map(i => i.json);\nconst prompts = $('ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚').all().map(i => i.json);\nreturn [{\n  json: {\n    success: true,\n    count: ideas.length,\n    ideas: ideas.map((idea, idx) => ({\n      idea: idea,\n      voice_script: scripts[idx] || null,\n      video_prompt: prompts[idx] || null\n    }))\n  }\n}];"
      },
      "id": "response",
      "name": "ğŸ“¤ ĞÑ‚Ğ²ĞµÑ‚",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4520, 300]
    },
    {
      "parameters": {
        "rule": {
          "interval": [{ "field": "cronExpression", "expression": "0 9 * * 1-5" }]
        }
      },
      "id": "cron-trigger",
      "name": "â° ĞŸĞ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [200, 520],
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "return [{ json: { count: 3, system_prompt: '', product_name: '', niche: '', extra_instructions: '' } }];"
      },
      "id": "cron-defaults",
      "name": "Cron Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [440, 520]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://dashboard:3001/api/internal/log-error",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"workflow_name\": \"content-brain\",\n  \"error_message\": \"{{ $json.error?.message || 'Unknown error' }}\",\n  \"node_name\": \"{{ $json.error?.node || '' }}\"\n}",
        "options": {},
        "onError": "continueRegularOutput"
      },
      "id": "error-handler",
      "name": "âŒ Ğ›Ğ¾Ğ³ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [920, 520]
    }
  ],
  "connections": {
    "ğŸ“¥ Webhook": { "main": [[{ "node": "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”", "type": "main", "index": 0 }]] },
    "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”": { "main": [[{ "node": "ğŸ”§ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°", "type": "main", "index": 0 }]] },
    "ğŸ”§ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°": { "main": [[{ "node": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸Ğ´ĞµĞ¹", "type": "main", "index": 0 }]] },
    "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸Ğ´ĞµĞ¹": { "main": [[{ "node": "ğŸ§  Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ´ĞµĞ¹", "type": "main", "index": 0 }]] },
    "ğŸ§  Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ´ĞµĞ¹": { "main": [[{ "node": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ¸Ğ´ĞµĞ¹", "type": "main", "index": 0 }]] },
    "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ¸Ğ´ĞµĞ¹": { "main": [[{ "node": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ´ĞµÑ", "type": "main", "index": 0 }]] },
    "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ´ĞµÑ": { "main": [[{ "node": "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ", "type": "main", "index": 0 }]] },
    "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ": { "main": [[{ "node": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ", "type": "main", "index": 0 }]] },
    "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ": { "main": [[{ "node": "ğŸ“ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ", "type": "main", "index": 0 }]] },
    "ğŸ“ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ": { "main": [[{ "node": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ", "type": "main", "index": 0 }]] },
    "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ñ": { "main": [[{ "node": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹", "type": "main", "index": 0 }]] },
    "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹": { "main": [[{ "node": "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°", "type": "main", "index": 0 }]] },
    "ğŸ”— ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°": { "main": [[{ "node": "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°", "type": "main", "index": 0 }]] },
    "ğŸ—ï¸ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°": { "main": [[{ "node": "ğŸ¬ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°", "type": "main", "index": 0 }]] },
    "ğŸ¬ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°": { "main": [[{ "node": "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°", "type": "main", "index": 0 }]] },
    "ğŸ“‹ ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ°": { "main": [[{ "node": "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚", "type": "main", "index": 0 }]] },
    "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¸Ğ´ĞµĞ¾-Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚": { "main": [[{ "node": "ğŸ“¡ Callback â†’ Dashboard", "type": "main", "index": 0 }]] },
    "ğŸ“¡ Callback â†’ Dashboard": { "main": [[{ "node": "ğŸ“¤ ĞÑ‚Ğ²ĞµÑ‚", "type": "main", "index": 0 }]] },
    "â° ĞŸĞ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ": { "main": [[{ "node": "Cron Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹", "type": "main", "index": 0 }]] },
    "Cron Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹": { "main": [[{ "node": "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”", "type": "main", "index": 0 }]] }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": ""
  },
  "staticData": null,
  "tags": []
}
